静态成员

**静态成员变量**

1.特性：

属于类，不是对象：所有对象共享一个静态变量，修改一个对象的静态变量其他对象的这个静态变量均改变

即使没有创建对象静态变量也存在，程序启动时初始化

必须类外初始化：类内仅声明静态变量，类外必须定义（给静态变量分配内存）

生命周期从程序启动到程序结束，存储在全局数据区

2.语法格式：

```c++
// 1. 类内声明（加 static 关键字）
class 类名 {
public:
    static 数据类型 变量名;  // 声明，不分配内存
};

// 2. 类外定义（初始化，分配内存）
// 注意：不加 static 关键字！
数据类型 类名::变量名 = 初始值;  // 初始值可选（默认初始化，如int默认0）

```

3.访问方式：

```c++
// 方式1：类名::静态变量名（推荐，无需创建对象）
类名::静态变量名;

// 方式2：对象.静态变量名（允许，但不推荐，易误解为对象级成员）
类名 对象;
对象.静态变量名;

```

4.示例：

```c++
#include <iostream>
using namespace std;

class Student {
public:
    string name;          // 普通成员（每个对象独有）
    static int studentCount;  // 静态成员（所有对象共享，统计学生总数）
private:
    statuc int m_B;
};

// 类外初始化静态变量（必须！不加 static）
int Student::studentCount = 0;
int Student::m_B=10;

int main() {
    // 1. 无对象时可直接访问静态变量
    cout << "初始学生数：" << Student::studentCount << endl;  // 输出 0
    cout<<Student::m_B<<endl//私有权限访问不到

    // 2. 创建对象，修改静态变量
    Student s1;
    s1.name = "张三";
    Student::studentCount++;  // 方式1：类名访问

    Student s2;
    s2.name = "李四";
    s2.studentCount++;        // 方式2：对象访问（不推荐）

    // 3. 所有对象共享静态变量
    cout << "s1 看到的学生数：" << s1.studentCount << endl;  // 输出 2
    cout << "s2 看到的学生数：" << s2.studentCount << endl;  // 输出 2
    cout << "类访问的学生数：" << Student::studentCount << endl;  // 输出 2

    return 0;
}

```

5.特殊：`static const `成员可在类内直接初始化

```c++
class Test {
public:
    static const int MAX_SIZE = 100;  // C++11+ 允许类内初始化
};
// 若需要取地址（如 &Test::MAX_SIZE），仍需类外定义（无需重复赋值）：
// const int Test::MAX_SIZE;

```

**静态成员函数**

静态成员函数只能访问静态成员变量

```c++
class Person
{

public:

	//静态成员函数特点：
	//1 程序共享一个函数
	//2 静态成员函数只能访问静态成员变量
	
	static void func()
	{
		cout << "func调用" << endl;
		m_A = 100;
		//m_B = 100; //错误，不可以访问非静态成员变量
	}

	static int m_A; //静态成员变量
	int m_B; // 
private:

	//静态成员函数也是有访问权限的
	static void func2()
	{
		cout << "func2调用" << endl;
	}
};
int Person::m_A = 10;


void test01()
{
	//静态成员变量两种访问方式

	//1、通过对象
	Person p1;
	p1.func();

	//2、通过类名
	Person::func();


	//Person::func2(); //私有权限访问不到
}

int main() {

	test01();

	system("pause");

	return 0;
}
```

不能是`const/volatile`函数

若需访问普通成员：必须通过函数参数传入对象实例（对象指针/引用）

```c++
private:
int x;//普通成员
static void printx(Test&obj){//传入对象引用
cout<<obj.x<<endl;//通过对象访问普通成员
}
```

区别

| 特性          | 静态成员（变量 / 函数）               | 普通成员（变量 / 函数）                     |
| ------------- | ------------------------------------- | ------------------------------------------- |
| 所属对象      | 类本身（所有对象共享）                | 单个对象（每个对象独有）                    |
| 访问方式      | 类名：：成员 / 对象。成员（推荐前者） | 仅对象。成员 / 指针 -> 成员                 |
| `this` 指针   | 无                                    | 有（指向当前对象）                          |
| 初始化 / 定义 | 变量需类外初始化；函数类内声明 + 实现 | 变量可通过构造函数初始化；函数类内 / 外实现 |
| 访问成员限制  | 只能访问静态成员                      | 可访问静态成员和普通成员                    |
| 生命周期      | 程序启动 -> 程序结束（全局区）        | 随对象创建 / 销毁（栈 / 堆区）              |
| 能否是虚函数  | 不能                                  | 可以（非静态普通成员函数）                  |



